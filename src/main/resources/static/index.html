<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo Application</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        .todo-list {
            margin-top: 20px;
        }
        .todo-item {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .todo-item.done {
            background-color: #f8f8f8;
            text-decoration: line-through;
        }
        .todo-title {
            font-weight: bold;
        }
        .todo-form {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        input, textarea, button {
            margin-bottom: 10px;
            padding: 8px;
            width: 100%;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Todo Application</h1>
    
    <div class="todo-form">
        <h2>Add New Todo</h2>
        <input type="text" id="todoTitle" placeholder="Title" required>
        <textarea id="todoDescription" placeholder="Description"></textarea>
        <button onclick="createTodo()">Add Todo</button>
    </div>
    
    <div class="todo-list" id="todoList">
        <!-- Todo items will be loaded here -->
    </div>

    <script>
        const API_URL = '/api/todos';
        
        // Load todos when page loads
        document.addEventListener('DOMContentLoaded', fetchTodos);
        
        // Fetch all todos
        function fetchTodos() {
            fetch(API_URL)
                .then(response => response.json())
                .then(todos => {
                    const todoList = document.getElementById('todoList');
                    todoList.innerHTML = '';
                    
                    todos.forEach(todo => {
                        const todoItem = document.createElement('div');
                        todoItem.className = `todo-item ${todo.isDone ? 'done' : ''}`;
                        todoItem.innerHTML = `
                            <div class="todo-title">${todo.title}</div>
                            <div class="todo-description">${todo.description || ''}</div>
                            <div class="todo-actions">
                                <button onclick="toggleTodo(${todo.id}, ${!todo.isDone})">
                                    ${todo.isDone ? 'Mark Undone' : 'Mark Done'}
                                </button>
                                <button onclick="deleteTodo(${todo.id})">Delete</button>
                            </div>
                        `;
                        todoList.appendChild(todoItem);
                    });
                })
                .catch(error => console.error('Error fetching todos:', error));
        }
        
        // Create a new todo
        function createTodo() {
            const title = document.getElementById('todoTitle').value;
            const description = document.getElementById('todoDescription').value;
            
            if (!title) {
                alert('Title is required');
                return;
            }
            
            fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    title,
                    description
                })
            })
            .then(response => response.json())
            .then(() => {
                document.getElementById('todoTitle').value = '';
                document.getElementById('todoDescription').value = '';
                fetchTodos();
            })
            .catch(error => console.error('Error creating todo:', error));
        }
        
        // Toggle todo's done status
        function toggleTodo(id, isDone) {
            fetch(`${API_URL}/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    isDone
                })
            })
            .then(response => response.json())
            .then(() => fetchTodos())
            .catch(error => console.error('Error updating todo:', error));
        }
        
        // Delete a todo
        function deleteTodo(id) {
            if (confirm('Are you sure you want to delete this todo?')) {
                fetch(`${API_URL}/${id}`, {
                    method: 'DELETE'
                })
                .then(() => fetchTodos())
                .catch(error => console.error('Error deleting todo:', error));
            }
        }
    </script>
</body>
</html>
